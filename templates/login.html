{% extends 'base.html' %}

{% block title %}Sign In — Vintage Auth{% endblock %}

{% block content %}
<div class="auth-wrapper">
    <!-- Decorative Header -->
    <div class="auth-header">
        <div class="ornament">❧</div>
        <h1 class="auth-title">Welcome Back</h1>
        <p class="auth-subtitle">Please sign in to your account</p>
        <div class="ornament">❧</div>
    </div>
    
    <!-- Authentication Card -->
    <div class="auth-card">
        <!-- Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="flash-message flash-{{ category }}">
                        <span class="flash-icon">
                            {% if category == 'success' %}✓{% elif category == 'error' %}✕{% elif category == 'warning' %}⚠{% else %}ℹ{% endif %}
                        </span>
                        <span class="flash-text">{{ message }}</span>
                        <button class="flash-close" onclick="this.parentElement.remove()">×</button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        
        <!-- Login Form -->
        <form method="POST" action="{{ url_for('login') }}" class="auth-form" id="loginForm">
            <!-- Email/Username Field -->
            <div class="form-group">
                <label for="identifier" class="form-label">Email or Username</label>
                <div class="input-wrapper">
                    <span class="input-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="8" r="4"></circle>
                            <path d="M20 21a8 8 0 1 0-16 0"></path>
                        </svg>
                    </span>
                    <input 
                        type="text" 
                        id="identifier" 
                        name="identifier" 
                        class="form-input" 
                        placeholder="Enter your email or username"
                        autocomplete="username"
                        required
                    >
                </div>
            </div>
            
            <!-- Password Field -->
            <div class="form-group">
                <label for="password" class="form-label">Password</label>
                <div class="input-wrapper">
                    <span class="input-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                            <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                        </svg>
                    </span>
                    <input 
                        type="password" 
                        id="password" 
                        name="password" 
                        class="form-input" 
                        placeholder="Enter your password"
                        autocomplete="current-password"
                        required
                    >
                    <button type="button" class="password-toggle" onclick="togglePassword('password')">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="eye-open">
                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                            <circle cx="12" cy="12" r="3"></circle>
                        </svg>
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="eye-closed" style="display: none;">
                            <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                            <line x1="1" y1="1" x2="23" y2="23"></line>
                        </svg>
                    </button>
                </div>
            </div>
            
            <!-- Remember Me & Forgot Password -->
            <div class="form-options">
                <label class="checkbox-wrapper">
                    <input type="checkbox" name="remember_me" class="checkbox-input">
                    <span class="checkbox-custom"></span>
                    <span class="checkbox-label">Remember me</span>
                </label>
                <a href="#" class="forgot-link">Forgot password?</a>
            </div>
            
            <!-- Submit Button -->
            <button type="submit" class="btn btn-primary" id="loginBtn">
                <span class="btn-text">Sign In</span>
                <span class="btn-loader" style="display: none;">
                    <span class="loader-dot"></span>
                    <span class="loader-dot"></span>
                    <span class="loader-dot"></span>
                </span>
            </button>
        </form>
        
        <!-- Divider -->
        <div class="auth-divider">
            <span class="divider-line"></span>
            <span class="divider-text">or</span>
            <span class="divider-line"></span>
        </div>
        
        <!-- Signup Link -->
        <div class="auth-footer">
            <p class="auth-footer-text">
                Don't have an account?
                <a href="{{ url_for('signup') }}" class="auth-link">Create one</a>
            </p>
        </div>
    </div>
    
    <!-- Decorative Footer -->
    <div class="auth-decoration">
        <span class="decoration-line"></span>
        <span class="decoration-symbol">✦</span>
        <span class="decoration-line"></span>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script>
    // Toggle Password Visibility
    function togglePassword(inputId) {
        const input = document.getElementById(inputId);
        const button = input.parentElement.querySelector('.password-toggle');
        const eyeOpen = button.querySelector('.eye-open');
        const eyeClosed = button.querySelector('.eye-closed');
        
        if (input.type === 'password') {
            input.type = 'text';
            eyeOpen.style.display = 'none';
            eyeClosed.style.display = 'block';
        } else {
            input.type = 'password';
            eyeOpen.style.display = 'block';
            eyeClosed.style.display = 'none';
        }
    }
    
    // Form Submission with Loading State
    document.getElementById('loginForm').addEventListener('submit', function(e) {
        const btn = document.getElementById('loginBtn');
        const btnText = btn.querySelector('.btn-text');
        const btnLoader = btn.querySelector('.btn-loader');
        
        btnText.style.display = 'none';
        btnLoader.style.display = 'flex';
        btn.disabled = true;
    });
    
    // Auto-hide flash messages
    setTimeout(() => {
        document.querySelectorAll('.flash-message').forEach(msg => {
            msg.style.opacity = '0';
            msg.style.transform = 'translateY(-10px)';
            setTimeout(() => msg.remove(), 300);
        });
    }, 5000);
</script>
{% endblock %}